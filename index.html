<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="KONrURUmPNj9tMLBA-hbEbW2UDoPYmrUtJaltV9Du04" />
    <title>Sahlan Hasan - Futuristic Portfolio & Community</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Orbitron:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- tsParticles for interactive background -->
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
    <!-- Typed.js for typing effect -->
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global Firebase instances and user ID
        window.firebaseApp = null;
        window.db = null;
        window.auth = null;
        window.currentUserId = null;
        window.isAuthReady = false; // Flag to indicate auth state is resolved

        // Function to show custom modal (replaces alert/confirm)
        window.showCustomModal = function(message, type = 'alert', callback = null) {
            const modalContainer = document.getElementById('custom-modal-container');
            const modalMessage = document.getElementById('custom-modal-message');
            const modalConfirmBtn = document.getElementById('custom-modal-confirm');
            const modalCancelBtn = document.getElementById('custom-modal-cancel');

            modalMessage.textContent = message;

            if (type === 'confirm') {
                modalConfirmBtn.style.display = 'inline-block';
                modalCancelBtn.style.display = 'inline-block';
                modalConfirmBtn.onclick = () => {
                    modalContainer.classList.remove('show-modal');
                    if (callback) callback(true);
                };
                modalCancelBtn.onclick = () => {
                    modalContainer.classList.remove('show-modal');
                    if (callback) callback(false);
                };
            } else { // 'alert' type
                modalConfirmBtn.style.display = 'inline-block';
                modalCancelBtn.style.display = 'none';
                modalConfirmBtn.onclick = () => {
                    modalContainer.classList.remove('show-modal');
                    if (callback) callback();
                };
            }
            modalContainer.classList.add('show-modal');
        };

        window.addEventListener('DOMContentLoaded', async () => {
            try {
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');

                if (Object.keys(firebaseConfig).length === 0) {
                    console.error("Firebase config is missing. Community features will not work.");
                    showCustomModal("Firebase configuration is missing. Community features will be disabled.", "alert");
                    return;
                }

                window.firebaseApp = initializeApp(firebaseConfig);
                window.db = getFirestore(window.firebaseApp);
                window.auth = getAuth(window.firebaseApp);

                onAuthStateChanged(window.auth, async (user) => {
                    if (user) {
                        window.currentUserId = user.uid;
                        console.log("Authenticated user ID:", window.currentUserId);
                    } else {
                        // Sign in anonymously if no initial auth token or user logs out
                        try {
                            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                await signInWithCustomToken(window.auth, __initial_auth_token);
                                window.currentUserId = window.auth.currentUser.uid;
                                console.log("Signed in with custom token. User ID:", window.currentUserId);
                            } else {
                                await signInAnonymously(window.auth);
                                window.currentUserId = window.auth.currentUser.uid;
                                console.log("Signed in anonymously. User ID:", window.currentUserId);
                            }
                        } catch (error) {
                            console.error("Firebase authentication failed:", error);
                            showCustomModal("Authentication failed. Community features might be limited.", "alert");
                            window.currentUserId = crypto.randomUUID(); // Fallback to a random ID
                        }
                    }
                    window.isAuthReady = true;
                    // Load posts only after auth state is resolved
                    if (window.db && window.currentUserId) {
                        window.loadPosts();
                    }
                });

            } catch (error) {
                console.error("Failed to initialize Firebase:", error);
                showCustomModal("Failed to initialize Firebase. Community features will be disabled.", "alert");
            }
        });
    </script>

    <style>
        /* Custom Modal Styles */
        .custom-modal-container {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7); /* Dark semi-transparent background */
            backdrop-filter: blur(5px); /* Frosted glass effect */
            justify-content: center;
            align-items: center;
        }
        .custom-modal-container.show-modal {
            display: flex;
        }
        .custom-modal-content {
            background: var(--card-bg);
            margin: auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            max-width: 400px;
            text-align: center;
            border: 1px solid var(--accent-color); /* Accent border */
            animation: fadeInScale 0.3s ease-out;
        }
        .custom-modal-content p {
            font-size: 1.1rem;
            margin-bottom: 25px;
            color: var(--text-color);
        }
        .custom-modal-content button {
            padding: 10px 25px;
            margin: 0 10px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s ease, background 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        .custom-modal-content button:hover {
            transform: translateY(-2px);
        }
        #custom-modal-confirm {
            background: linear-gradient(135deg, var(--accent-color), #00e67a);
            color: var(--bg-color);
        }
        #custom-modal-cancel {
            background: #444;
            color: var(--text-color);
        }

        /* Keyframe for modal animation */
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Scroll Progress Bar */
        #progressContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: rgba(0, 0, 0, 0.1);
            z-index: 2000;
        }
        #progressBar {
            height: 100%;
            background: var(--accent-color);
            width: 0%;
            box-shadow: 0 0 10px var(--accent-color); /* Glow effect */
        }
        
        /* CSS Variables and Base Styles */
        :root {
            --bg-color: #1a1a1a;
            --text-color: #ffffff;
            --card-bg: #2a2a2a;
            --accent-color: #00ff88;
            --secondary-accent: #00aaff; /* New secondary accent */
            --border-color: #444;
            --header-bg: rgba(0, 0, 0, 0.8);
            --glow-color: rgba(0, 255, 136, 0.5); /* Glow for accent */
        }
        .light-theme {
            --bg-color: #ffffff;
            --text-color: #1a1a1a;
            --card-bg: #f0f0f0;
            --accent-color: #00cc66;
            --secondary-accent: #0077cc;
            --border-color: #ddd;
            --header-bg: rgba(255, 255, 255, 0.8);
            --glow-color: rgba(0, 204, 102, 0.3);
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
            overflow-x: hidden; /* Prevent horizontal scroll from particles */
        }

        /* tsParticles container */
        #tsparticles {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1; /* Behind content */
        }

        /* Fixed Navigation Bar */
        header {
            position: fixed;
            top: 5px; /* below progress bar */
            width: 100%;
            background: var(--header-bg);
            padding: 10px 20px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            border-radius: 0 0 10px 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        nav .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent-color);
            text-shadow: 0 0 8px var(--glow-color);
            transition: text-shadow 0.3s ease;
        }
        nav .logo:hover {
            text-shadow: 0 0 15px var(--accent-color), 0 0 25px var(--secondary-accent);
        }
        nav ul {
            list-style: none;
            display: flex;
            gap: 25px;
            margin: 0;
            padding: 0;
        }
        nav ul li a {
            text-decoration: none;
            color: var(--text-color);
            font-weight: 500;
            transition: color 0.3s, text-shadow 0.3s;
            position: relative;
            padding-bottom: 5px;
        }
        nav ul li a::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 0;
            height: 2px;
            background: var(--accent-color);
            transition: width 0.3s ease-out;
        }
        nav ul li a:hover {
            color: var(--accent-color);
            text-shadow: 0 0 5px var(--glow-color);
        }
        nav ul li a:hover::after {
            width: 100%;
        }

        /* Mobile Navigation */
        .menu-toggle {
            display: none;
            font-size: 1.8rem;
            color: var(--text-color);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .menu-toggle:hover {
            transform: scale(1.1);
            color: var(--accent-color);
        }
        @media screen and (max-width: 768px) {
            nav ul {
                flex-direction: column;
                background: var(--header-bg);
                position: absolute;
                top: 60px;
                right: 20px;
                display: none;
                padding: 15px;
                border-radius: 10px;
                box-shadow: 0 8px 20px rgba(0,0,0,0.4);
                border: 1px solid var(--border-color);
                width: calc(100% - 40px); /* Adjust width for padding */
                max-width: 250px; /* Limit max width */
                align-items: flex-start;
            }
            nav ul li {
                width: 100%;
                text-align: left;
                margin-bottom: 10px;
            }
            nav ul li:last-child {
                margin-bottom: 0;
            }
            nav ul.show {
                display: flex;
            }
            .menu-toggle {
                display: block;
            }
        }

        /* Hero Section */
        #hero {
            position: relative; /* For tsParticles positioning */
            height: 100vh;
            background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(0,0,0,0.8));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            overflow: hidden; /* Hide particles overflow */
        }
        #hero h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 4.5rem;
            color: var(--accent-color);
            margin-bottom: 20px;
            animation: fadeIn 2s ease-in-out;
            text-shadow: 0 0 15px var(--glow-color), 0 0 25px var(--accent-color);
            z-index: 2; /* Above particles */
        }
        #hero p {
            font-size: 1.3rem;
            max-width: 700px;
            margin-bottom: 40px;
            z-index: 2; /* Above particles */
            color: rgba(255, 255, 255, 0.9);
        }
        #hero .btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--accent-color), #00e67a);
            color: var(--bg-color);
            border: none;
            border-radius: 50px; /* More rounded */
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4); /* Glow shadow */
            z-index: 2; /* Above particles */
        }
        #hero .btn:hover {
            opacity: 0.9;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 255, 136, 0.6);
        }

        /* Main Content Container */
        .container {
            max-width: 1000px;
            margin: 120px auto 40px auto; /* adjusted for fixed header & progress bar */
            padding: 20px;
        }
        /* Section Styles */
        .section {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px; /* More rounded */
            margin: 40px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            animation: slideUp 0.8s ease-in-out forwards; /* Added forwards to keep final state */
            opacity: 0; /* Start hidden for animation */
            border: 1px solid var(--border-color);
            position: relative; /* For pseudo-elements */
            overflow: hidden; /* Ensure content stays within rounded corners */
        }
        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(0, 255, 136, 0.05) 0%, transparent 40%),
                        radial-gradient(circle at bottom right, rgba(0, 170, 255, 0.05) 0%, transparent 40%);
            z-index: 0;
            pointer-events: none;
        }
        .section h2 {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-color);
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--glow-color);
            position: relative;
            z-index: 1;
        }
        .section p, .section ul li {
            position: relative;
            z-index: 1;
        }

        /* Profile Image in About Section */
        .profile-img {
            width: 180px; /* Slightly larger */
            height: 180px;
            border-radius: 50%;
            border: 5px solid var(--accent-color); /* Thicker border */
            margin: -90px auto 20px auto; /* Adjusted for larger image */
            display: block;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.6); /* Glow on image */
            object-fit: cover; /* Ensure image covers the area */
        }
        .profile-img:hover {
            transform: scale(1.15) rotate(5deg); /* More dynamic hover */
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.8), 0 0 40px rgba(0, 170, 255, 0.5);
        }
        /* List Styling */
        .section ul {
            list-style: none;
            padding: 0;
        }
        .section ul li {
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
            font-size: 1.1rem;
        }
        .section ul li::before {
            content: '\2022'; /* Bullet point */
            color: var(--accent-color);
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: -2px;
            line-height: 1;
            text-shadow: 0 0 5px var(--glow-color);
        }

        /* Download Resume Button */
        .btn-download {
            margin-top: 20px;
            display: inline-block;
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--accent-color), #00e67a);
            color: var(--bg-color);
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4);
        }
        .btn-download:hover {
            opacity: 0.9;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 255, 136, 0.6);
        }

        /* Testimonials Section - Enhanced Slider */
        .testimonial-slider {
            position: relative;
            overflow: hidden;
            padding: 20px;
            border-radius: 10px;
            background: rgba(0,0,0,0.2); /* Slightly darker background for slider */
            box-shadow: inset 0 0 15px rgba(0,0,0,0.3);
        }
        .testimonial-wrapper {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .testimonial {
            flex: 0 0 100%; /* Each testimonial takes full width */
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            opacity: 0;
            transform: scale(0.9);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .testimonial.active {
            opacity: 1;
            transform: scale(1);
        }
        .testimonial p {
            font-style: italic;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.9);
        }
        .testimonial small {
            display: block;
            font-weight: 600;
            color: var(--secondary-accent);
            font-size: 0.95rem;
            text-shadow: 0 0 5px rgba(0, 170, 255, 0.3);
        }
        .slider-controls {
            text-align: center;
            margin-top: 20px;
        }
        .slider-dot {
            height: 10px;
            width: 10px;
            margin: 0 5px;
            background-color: var(--border-color);
            border-radius: 50%;
            display: inline-block;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .slider-dot.active {
            background-color: var(--accent-color);
            transform: scale(1.2);
            box-shadow: 0 0 8px var(--glow-color);
        }

        /* Redesigned Community Feed */
        .create-post {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px dashed var(--accent-color);
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        .create-post input[type="text"],
        .create-post textarea {
            width: calc(100% - 24px); /* Adjust for padding */
            padding: 12px;
            margin: 10px 0;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-color);
            color: var(--text-color);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
            outline: none;
        }
        .create-post input[type="text"]:focus,
        .create-post textarea:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.2);
        }
        .create-post input[type="file"] {
            display: none;
        }
        /* Redesigned File Label & Post Button */
        .file-label, 
        #post-btn {
            display: inline-block;
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--accent-color), #00e67a);
            color: var(--bg-color);
            border-radius: 50px;
            cursor: pointer;
            transition: opacity 0.3s, transform 0.3s, box-shadow 0.3s;
            margin: 10px 5px; /* Adjusted margin */
            border: none;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(0, 255, 136, 0.3);
        }
        .file-label:hover, 
        #post-btn:hover {
            opacity: 0.9;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 255, 136, 0.5);
        }

        /* Redesigned Post Icon UI for Action Buttons */
        .post {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--border-color);
        }
        .post:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.6);
        }
        .post header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border-color);
            padding-bottom: 10px;
        }
        .post header strong {
            font-size: 1.2rem;
            color: var(--secondary-accent);
            text-shadow: 0 0 5px rgba(0, 170, 255, 0.3);
        }
        .post header small {
            font-size: 0.9rem;
            color: #aaa;
        }
        .post p {
            margin: 15px 0;
            font-size: 1.05rem;
            word-wrap: break-word; /* Ensure long words wrap */
        }
        .post img {
            max-width: 100%;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            object-fit: cover;
            height: auto; /* Ensure aspect ratio is maintained */
        }
        .post-actions {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            gap: 10px;
            margin-top: 15px;
            justify-content: flex-start; /* Align to start */
        }
        .post-actions button {
            background: linear-gradient(135deg, var(--accent-color), #00e67a);
            color: var(--bg-color);
            border: none;
            padding: 10px 15px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 8px; /* Spacing between icon and text */
            transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
            box-shadow: 0 3px 8px rgba(0, 255, 136, 0.2);
        }
        .post-actions button:hover {
            background: #00d676;
            transform: translateY(-3px);
            box-shadow: 0 5px 12px rgba(0, 255, 136, 0.4);
        }
        .post-actions button i {
            transition: transform 0.2s ease;
        }
        .post-actions button:hover i {
            transform: scale(1.2);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 25px;
            background: var(--card-bg);
            border-top: 1px solid var(--border-color);
            margin-top: 50px;
            border-radius: 10px 10px 0 0;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.3);
        }
        footer p {
            margin: 0;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Theme Toggle Button */
        #theme-toggle {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 12px; /* Slightly larger */
            border-radius: 50%;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s, background 0.3s, box-shadow 0.3s;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        #theme-toggle:hover {
            transform: rotate(180deg) scale(1.1);
            background: var(--accent-color);
            color: var(--bg-color);
            box-shadow: 0 6px 15px rgba(0, 255, 136, 0.4);
        }

        /* Back to Top Button */
        #back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--accent-color);
            color: var(--bg-color);
            border: none;
            padding: 12px 18px; /* Slightly larger */
            border-radius: 50px; /* More rounded */
            cursor: pointer;
            display: none;
            z-index: 1000;
            transition: opacity 0.3s, transform 0.3s, box-shadow 0.3s;
            font-size: 1.1rem;
            box-shadow: 0 4px 10px rgba(0, 255, 136, 0.4);
        }
        #back-to-top:hover {
            opacity: 0.9;
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 255, 136, 0.6);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Responsive adjustments */
        @media screen and (max-width: 900px) {
            #hero h1 {
                font-size: 3.5rem;
            }
            .section h2 {
                font-size: 2rem;
            }
        }
        @media screen and (max-width: 600px) {
            #hero h1 {
                font-size: 2.5rem;
            }
            #hero p {
                font-size: 1rem;
            }
            .section h2 {
                font-size: 1.8rem;
            }
            .section {
                padding: 20px;
                margin: 30px 0;
            }
            .profile-img {
                width: 120px;
                height: 120px;
                margin: -60px auto 15px auto;
            }
            .post-actions button {
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            .create-post, .post {
                padding: 15px;
            }
            .file-label, #post-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Custom Modal Structure -->
    <div id="custom-modal-container" class="custom-modal-container">
        <div class="custom-modal-content">
            <p id="custom-modal-message"></p>
            <button id="custom-modal-confirm">OK</button>
            <button id="custom-modal-cancel">Cancel</button>
        </div>
    </div>

    <!-- Scroll Progress Bar -->
    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>
    
    <!-- Navigation -->
    <header>
        <nav>
            <div class="logo">Sahlan Hasan</div>
            <div class="menu-toggle" id="mobile-menu"><i class="fa fa-bars"></i></div>
            <ul id="navbar">
                <li><a href="#hero">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#skills">Skills</a></li>
                <li><a href="#projects">Projects</a></li>
                <li><a href="#testimonials">Testimonials</a></li>
                <li><a href="#community">Community</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>
    
    <!-- Hero Section -->
    <section id="hero">
        <div id="tsparticles"></div> <!-- Particle background container -->
        <h1><span id="typed-text"></span></h1>
        <p>I’m Sahlan Hasan – CEO &amp; Founder of NeuraFlow AI Pro. A tech enthusiast, web developer, and innovator shaping the future with creative solutions.</p>
        <a href="#about" class="btn">Learn More</a>
    </section>
    
    <!-- Theme Toggle -->
    <button id="theme-toggle">🌓</button>
    
    <!-- Main Content Container -->
    <div class="container">
        <!-- About Section -->
        <section class="section" id="about">
            <img src="https://i.postimg.cc/Gh43Lv1z/PYUQSPU2-HRDB7-PFG7-BEEZ232-VE.avif" alt="Sahlan Hasan" class="profile-img">
            <h2>About Me</h2>
            <p>
                Hi, I'm Sahlan Hasan, CEO &amp; Founder of NeuraFlow AI Pro. With a deep passion for technology and innovation, I've built a career bridging the gap between entrepreneurial vision and cutting-edge web development. My journey is defined by creativity, dedication, and the drive to create solutions that push boundaries—from modern web applications to pioneering AI-driven projects.
            </p>
            <a href="resume.pdf" class="btn-download" download>Download Resume</a>
        </section>
        
        <!-- Skills Section -->
        <section class="section" id="skills">
            <h2>Skills</h2>
            <ul>
                <li>Tech Entrepreneurship</li>
                <li>Full Stack Development</li>
                <li>AI &amp; Machine Learning</li>
                <li>Innovative Problem Solving</li>
                <li>Responsive UI/UX Design</li>
            </ul>
        </section>
        
        <!-- Projects Section -->
        <section class="section" id="projects">
            <h2>Projects</h2>
            <div style="margin-top: 20px;">
                <h3>NeuraFlow AI Pro</h3>
                <p>CEO &amp; Founder – <a href="https://neuraflowaipro.github.io/NeuraFlowAi/" target="_blank" style="color: var(--accent-color);">Visit NeuraFlow AI Pro</a></p>
            </div>
        </section>
        
        <!-- Testimonials Section -->
        <section class="section" id="testimonials">
            <h2>Testimonials</h2>
            <div class="testimonial-slider">
                <div class="testimonial-wrapper">
                    <div class="testimonial">
                        <p>"Sahlan's innovative approach is truly inspiring!"</p>
                        <small>- Jane Doe, CEO of TechCorp</small>
                    </div>
                    <div class="testimonial">
                        <p>"Working with him has transformed our business."</p>
                        <small>- John Smith, CTO of Innovate Inc.</small>
                    </div>
                    <div class="testimonial">
                        <p>"His expertise in web development and AI is unmatched."</p>
                        <small>- Alex Lee, Founder of StartupX</small>
                    </div>
                </div>
                <div class="slider-controls">
                    <span class="slider-dot active" data-index="0"></span>
                    <span class="slider-dot" data-index="1"></span>
                    <span class="slider-dot" data-index="2"></span>
                </div>
            </div>
        </section>
        
        <!-- Community Feed Section -->
        <section class="section" id="community">
            <h2>Community Feed</h2>
            <p>Your User ID: <span id="user-id-display">Loading...</span></p>
            <div class="create-post">
                <input type="text" id="username-input" placeholder="Your Name (optional)">
                <textarea id="post-text" placeholder="Share your thoughts..."></textarea>
                <br>
                <label for="image-upload" class="file-label"><i class="fa fa-upload"></i> Choose File</label>
                <input type="file" id="image-upload" accept="image/*">
                <button id="post-btn">Post</button>
            </div>
            <div id="posts">
                <!-- Posts will be loaded here from Firestore -->
            </div>
        </section>
        
        <!-- Contact Section -->
        <section class="section" id="contact">
            <h2>Contact</h2>
            <p>📧 <a href="mailto:sahlanhasan08@gmail.com" style="color: var(--accent-color);">sahlanhasan08@gmail.com</a></p>
            <p>Explore more: <a href="https://neuraflowaipro.github.io/NeuraFlowAi/" target="_blank" style="color: var(--accent-color);">NeuraFlow AI Pro Website</a></p>
        </section>
    </div>
    
    <!-- Footer -->
    <footer>
        <p>&copy; 2025 Sahlan Hasan. All rights reserved.</p>
    </footer>
    
    <!-- Back to Top Button -->
    <button id="back-to-top">Back to Top</button>
    
    <script type="module">
        // Ensure Firebase is initialized before proceeding with app logic that depends on it
        window.addEventListener('DOMContentLoaded', () => {
            // Wait for Firebase to be ready
            const checkFirebaseReady = setInterval(() => {
                if (window.isAuthReady && window.db && window.auth && window.currentUserId) {
                    clearInterval(checkFirebaseReady);
                    console.log("Firebase is ready. Starting app logic.");
                    document.getElementById('user-id-display').textContent = window.currentUserId;
                    // Initial load of posts is now triggered by onAuthStateChanged
                }
            }, 100); // Check every 100ms
        });

        // Scroll Progress Bar Update
        window.addEventListener("scroll", function() {
            let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            let scrolled = (winScroll / height) * 100;
            document.getElementById("progressBar").style.width = scrolled + "%";
        });
        
        // Mobile Menu Toggle
        const mobileMenu = document.getElementById('mobile-menu');
        const navbar = document.getElementById('navbar');
        mobileMenu.addEventListener('click', () => {
            navbar.classList.toggle('show');
        });
        
        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-theme');
        });
        
        // Testimonials Slider
        let testimonialIndex = 0;
        const testimonialsWrapper = document.querySelector('.testimonial-wrapper');
        const testimonials = document.querySelectorAll('.testimonial');
        const sliderDots = document.querySelectorAll('.slider-dot');

        function showTestimonial(index) {
            if (testimonials.length === 0) return;
            testimonialIndex = index % testimonials.length;
            if (testimonialIndex < 0) {
                testimonialIndex = testimonials.length - 1;
            }

            testimonialsWrapper.style.transform = `translateX(-${testimonialIndex * 100}%)`;

            testimonials.forEach((testimonial, i) => {
                testimonial.classList.remove('active');
            });
            testimonials[testimonialIndex].classList.add('active');

            sliderDots.forEach((dot, i) => {
                dot.classList.remove('active');
            });
            sliderDots[testimonialIndex].classList.add('active');
        }

        function nextTestimonial() {
            showTestimonial(testimonialIndex + 1);
        }

        // Initialize slider
        if (testimonials.length > 0) {
            showTestimonial(0); // Show the first testimonial initially
            setInterval(nextTestimonial, 5000); // Auto-advance every 5 seconds
        }

        sliderDots.forEach(dot => {
            dot.addEventListener('click', () => {
                const index = parseInt(dot.dataset.index);
                showTestimonial(index);
            });
        });

        // Community Feed System with Firestore
        // This function is now global and called after Firebase auth is ready
        window.loadPosts = function() {
            if (!window.db || !window.currentUserId) {
                console.log("Firestore not ready, cannot load posts.");
                return;
            }

            const postsContainer = document.getElementById('posts');
            const postsCollectionRef = firebase.firestore.collection(window.db, `artifacts/${__app_id}/public/data/communityPosts`);

            onSnapshot(postsCollectionRef, (snapshot) => {
                const fetchedPosts = [];
                snapshot.forEach(doc => {
                    fetchedPosts.push({ id: doc.id, ...doc.data() });
                });

                // Sort posts by timestamp in descending order (newest first)
                fetchedPosts.sort((a, b) => {
                    // Handle Firestore Timestamp objects and potential nulls
                    const timeA = a.timestamp ? (a.timestamp.toDate ? a.timestamp.toDate().getTime() : new Date(a.timestamp).getTime()) : 0;
                    const timeB = b.timestamp ? (b.timestamp.toDate ? b.timestamp.toDate().getTime() : new Date(b.timestamp).getTime()) : 0;
                    return timeB - timeA;
                });

                postsContainer.innerHTML = ''; // Clear existing posts
                fetchedPosts.forEach(post => {
                    const postDiv = document.createElement('div');
                    postDiv.className = 'post';
                    const postDate = post.timestamp ? (post.timestamp.toDate ? post.timestamp.toDate().toLocaleString() : new Date(post.timestamp).toLocaleString()) : 'N/A';
                    
                    // Check if the current user is the author of the post
                    const isAuthor = post.authorId === window.currentUserId;

                    postDiv.innerHTML = `
                        <header>
                            <strong>${post.username || "Anonymous"}</strong>
                            <small>${post.userId ? `User ID: ${post.userId}` : ''} | ${postDate}</small>
                        </header>
                        <p class="post-text">${post.text}</p>
                        ${post.image ? `<img src="${post.image}" alt="Post image">` : ''}
                        <div class="post-actions">
                            <button class="like-btn" data-id="${post.id}"><i class="fa fa-thumbs-up"></i> ${post.likes || 0}</button>
                            ${isAuthor ? `<button class="edit-btn" data-id="${post.id}"><i class="fa fa-edit"></i> Edit</button>` : ''}
                            <button class="share-btn" data-id="${post.id}"><i class="fa fa-share"></i> Share</button>
                            ${isAuthor ? `<button class="delete-btn" data-id="${post.id}"><i class="fa fa-trash"></i> Delete</button>` : ''}
                        </div>
                    `;
                    
                    postsContainer.appendChild(postDiv);
                });

                // Attach event listeners after rendering
                postsContainer.querySelectorAll('.like-btn').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const postId = e.currentTarget.dataset.id;
                        try {
                            const postRef = firebase.firestore.doc(window.db, `artifacts/${__app_id}/public/data/communityPosts`, postId);
                            const postDoc = await firebase.firestore.getDoc(postRef);
                            if (postDoc.exists()) {
                                const currentLikes = postDoc.data().likes || 0;
                                await firebase.firestore.updateDoc(postRef, { likes: currentLikes + 1 });
                                console.log("Post liked!");
                            }
                        } catch (error) {
                            console.error("Error liking post:", error);
                            showCustomModal("Failed to like post. Please try again.", "alert");
                        }
                    });
                });

                postsContainer.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const postId = e.currentTarget.dataset.id;
                        window.showCustomModal('Are you sure you want to delete this post?', 'confirm', async (result) => {
                            if (result) {
                                try {
                                    await firebase.firestore.deleteDoc(firebase.firestore.doc(window.db, `artifacts/${__app_id}/public/data/communityPosts`, postId));
                                    console.log("Post deleted!");
                                } catch (error) {
                                    console.error("Error deleting post:", error);
                                    showCustomModal("Failed to delete post. Please try again.", "alert");
                                }
                            }
                        });
                    });
                });

                postsContainer.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const postId = e.currentTarget.dataset.id;
                        const postRef = firebase.firestore.doc(window.db, `artifacts/${__app_id}/public/data/communityPosts`, postId);
                        const postDoc = await firebase.firestore.getDoc(postRef);
                        if (postDoc.exists()) {
                            const currentText = postDoc.data().text;
                            window.showCustomModal('Edit your post:', 'prompt', (newText) => { // Using prompt-like modal
                                if (newText !== null && newText.trim() !== '') {
                                    try {
                                        firebase.firestore.updateDoc(postRef, {
                                            text: newText,
                                            timestamp: firebase.firestore.serverTimestamp() // Update timestamp on edit
                                        });
                                        console.log("Post updated!");
                                    } catch (error) {
                                        console.error("Error updating post:", error);
                                        showCustomModal("Failed to update post. Please try again.", "alert");
                                    }
                                }
                            });
                        }
                    });
                });

                postsContainer.querySelectorAll('.share-btn').forEach(button => {
                    button.addEventListener('click', async (e) => {
                        const postId = e.currentTarget.dataset.id;
                        const postRef = firebase.firestore.doc(window.db, `artifacts/${__app_id}/public/data/communityPosts`, postId);
                        const postDoc = await firebase.firestore.getDoc(postRef);
                        if (postDoc.exists()) {
                            const postData = postDoc.data();
                            const shareText = `Check out this post by ${postData.username || 'Anonymous'} on Sahlan's portfolio:\n"${postData.text}"\nPosted on: ${postData.timestamp ? (postData.timestamp.toDate ? postData.timestamp.toDate().toLocaleString() : new Date(postData.timestamp).toLocaleString()) : 'N/A'}`;
                            try {
                                // Fallback for navigator.clipboard.writeText due to iframe restrictions
                                const textArea = document.createElement("textarea");
                                textArea.value = shareText;
                                document.body.appendChild(textArea);
                                textArea.select();
                                document.execCommand('copy');
                                textArea.remove();
                                showCustomModal('Post copied to clipboard!', 'alert');
                            } catch (err) {
                                console.error('Failed to copy text:', err);
                                showCustomModal('Failed to copy text. Please try manually.', 'alert');
                            }
                        }
                    });
                });
            });
        };

        document.getElementById('post-btn').addEventListener('click', () => {
            if (!window.db || !window.currentUserId) {
                showCustomModal("Community features are not available. Firebase not initialized.", "alert");
                return;
            }

            const usernameInput = document.getElementById('username-input').value || "Anonymous";
            const text = document.getElementById('post-text').value;
            const imageInput = document.getElementById('image-upload');
            const file = imageInput.files[0];

            if (!text.trim() && !file) {
                showCustomModal("Please enter some text or select an image to post.", "alert");
                return;
            }

            const loadingModalId = Date.now(); // Unique ID for this loading modal
            showCustomModal('<div class="loading-spinner"></div> Posting...', 'alert'); // Show loading spinner

            const reader = new FileReader();
            reader.onload = async function(e) {
                const newPost = {
                    username: usernameInput,
                    text: text,
                    image: file ? e.target.result : null,
                    likes: 0,
                    timestamp: firebase.firestore.serverTimestamp(), // Use server timestamp
                    userId: window.currentUserId, // Store the user ID
                    authorId: window.currentUserId // Store the author's UID for edit/delete checks
                };
                
                try {
                    const docRef = await firebase.firestore.addDoc(firebase.firestore.collection(window.db, `artifacts/${__app_id}/public/data/communityPosts`), newPost);
                    console.log("Document written with ID: ", docRef.id);
                    document.getElementById('post-text').value = '';
                    imageInput.value = '';
                    document.getElementById('username-input').value = '';
                    // No need to call loadPosts() explicitly, onSnapshot will handle it
                    showCustomModal("Post created successfully!", "alert"); // Replace loading modal with success
                } catch (e) {
                    console.error("Error adding document: ", e);
                    showCustomModal("Error creating post. Please try again.", "alert");
                }
            };
            file ? reader.readAsDataURL(file) : reader.onload();
        });
        
        // Back to Top Button
        const backToTopBtn = document.getElementById('back-to-top');
        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        window.addEventListener('scroll', () => {
            backToTopBtn.style.display = window.scrollY > 300 ? 'block' : 'none';
        });

        // tsParticles initialization
        tsParticles.load({
            id: "tsparticles",
            options: {
                background: {
                    color: {
                        value: "transparent",
                    },
                },
                fpsLimit: 60,
                interactivity: {
                    events: {
                        onClick: {
                            enable: true,
                            mode: "push",
                        },
                        onHover: {
                            enable: true,
                            mode: "repulse",
                        },
                        resize: true,
                    },
                    modes: {
                        push: {
                            quantity: 4,
                        },
                        repulse: {
                            distance: 100,
                            duration: 0.4,
                        },
                    },
                },
                particles: {
                    color: {
                        value: ["#00ff88", "#00aaff", "#ffffff"], // Multiple colors for particles
                    },
                    links: {
                        color: "#ffffff",
                        distance: 150,
                        enable: true,
                        opacity: 0.3,
                        width: 1,
                    },
                    move: {
                        direction: "none",
                        enable: true,
                        outModes: {
                            default: "bounce",
                        },
                        random: false,
                        speed: 1,
                        straight: false,
                    },
                    number: {
                        density: {
                            enable: true,
                            area: 800,
                        },
                        value: 80,
                    },
                    opacity: {
                        value: 0.5,
                    },
                    shape: {
                        type: "circle",
                    },
                    size: {
                        value: { min: 1, max: 5 },
                    },
                },
                detectRetina: true,
            },
        });

        // Typed.js initialization
        const typed = new Typed('#typed-text', {
            strings: ['Welcome to My World', 'Innovating the Future', 'Sahlan Hasan - Portfolio'],
            typeSpeed: 50,
            backSpeed: 25,
            loop: true,
            showCursor: true,
            cursorChar: '|',
        });

        // Intersection Observer for section animations
        const sections = document.querySelectorAll('.section');
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const sectionObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                    observer.unobserve(entry.target); // Stop observing once animated
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            sectionObserver.observe(section);
        });

    </script>
</body>
</html>
